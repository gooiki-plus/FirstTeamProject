<!DOCTYPE html>
<html>
    <!-- head section -->
<head>
    <meta charset="UTF-8">
    <!-- title section -->
    <title>Gooiki Plus</title>

    <!-- <links section> -->
    <!-- bootstrap -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <!-- css -->
    <link rel="stylesheet" type="text/css" href="assets/css/style.css">
    <!-- font awesome -->
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/all.css" integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf" crossorigin="anonymous">
    <!-- google fonts -->
    <link href="https://fonts.googleapis.com/css?family=Libre+Franklin" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Merriweather" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Varela+Round" rel="stylesheet">
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://www.gstatic.com/firebasejs/5.9.4/firebase.js"></script>
    <script src="https://apis.google.com/js/api.js"></script>
</head>
<body>

      
      <!-- nav bar section -->
      <nav class="navbar navbar-light bg-white" style="background-color: orange">
        <span class="navbar-brand mb-0 h1">Gooiki Plus</span>
      </nav>
      
      <!-- banner section -->
      <div class="container1">
        <div class="banner">
            <h2> Gooiki Plus tracks where your<br>images appear online.</h2>

            <div id="filesubmit">
           
            <input type="file" class="file-select" accept="image/*" onchange="readURL(this);"/>
            <img id="pic" src="#">
            <button class="file-submit">Submit</button>
            </div>  
            
   
</div> 
</div>
            

      </div>
        </div>
        
        <div class="subheading">
            <h5><a href="#overview">Overview</a><h5>
            <h5><a href="#howitworks">How Gooiki Plus works</a></h5>
            <h5><a href="#features">Features</a></h5>
        </div>

        <div class="gooiki-content">
            <h3 id= "overview">For anyone who needs to track their<br>proprietary images</h3>
            <p id="overview-text">Gooiki takes your pictures and runs them through Google’s Cloud Vision API. Using <br> Google’s Machine learning prowess, we are able to pull out information, like the logos in your pictures! <br> We then run that information through Wikipedia for you, so you instantaneously become an expert on what is in your photo!
            </div>

        <!-- image/reveal section -->
        <div class="results">
        <img id="myImage" src="">
        <div id="results">
            <p id="result"></p>
            <p id="result2"></p>
            <p id="result3"></p>
            <p id="result4"></p>
        </div>
        </div>

        <!-- how it works section -->
        <div class="function-section">
            <div id="howitworks">
                <h3>How Gooiki Plus works</h3>
<div class="row">
                <div class="branch">
                <div class="col-md-6">
                    <p id="overviewtext"></p>Use <strong> Google Cloud Vision </strong> to build and <strong> deploy fast, high accuracy models </strong> to classify <strong> images. </strong></p>
                </div>
                </div>
                <div class="branch">
                <div class="col-md-6">
                    <p id="overviewtext"> Take a <strong> picture. </strong> </p>
                </div>
                 </div>
 </div>
<div class="row">
                <div class="branch">
                    <div class="col-md-6">
                    <p id="overviewtext">Using our <strong>image recognintion technology,</strong>
                        we use <strong>Google Cloud Vision</strong> & <strong>Wikipedia</strong> APIs to obtain accature data. </p>
                    
                    </div>
                </div>
                <div class="branch">
                    <div class="col-md-6">
                        <p id="overviewtext"> It can <strong>review your images </strong> and esitmate the likelihood that any given <strong> image includes content. </strong> </p>
                    </div>
                </div>
 </div>

            </div>
                    
                
             </div>
            

        <!-- FEATURES SECTION -->
    <div id ="features">
         <div class="row">
                <div class="col-md-3">
                <i class="fas fa-project-diagram"></i>
                <br>
                <span>Search and flitering.</span>
            </div>

            <div class="col-md-3">
                <i class="fas fa-file-upload"></i>
                <br>
                <span>Upload your image from your browser.</span>
            </div>

            <div class="col-md-3">
                <i class="fas fa-brain"></i>
                <br>
                <span>Knowledge is power.</span>
             </div>

             <div class="col-md-3">
                <i class="fas fa-user-friends"></i> 
                <br>
                <span>  +  User-friendly</span>
            </div>
        </div>
        
            <!-- <span>Upload your images from your browser</span> -->
            <!-- <span>test uploading file</span> -->
        </div>
            











            </div>
            </div>

        <!--footer section -->
        <div class="content">
        <div class="content-inside">

        </div>
        </div>
        <footer class="footer">
            <!-- <p>Gooiki Plus</p> -->
            
         </footer>

<script>
  function readURL(input) {
    var reader = new FileReader();
    reader.onload = function(e) {
      $('#pic').attr('src', e.target.result).width(200).height(150);
    };
    reader.readAsDataURL(input.files[0]);
  } 

  // Initialize Firebase
  var config = {
    apiKey: "AIzaSyDX1cgJaNiRT8ynhSrjLs_jnYGgeIO8_QA",
    authDomain: "image-upload-8a4d2.firebaseapp.com",
    databaseURL: "https://image-upload-8a4d2.firebaseio.com",
    projectId: "image-upload-8a4d2",
    storageBucket: "image-upload-8a4d2.appspot.com",
    messagingSenderId: "1076296379594"
  };
  firebase.initializeApp(config);

  // Declaration of variables for Firebase
  const storageService = firebase.storage();
  const storageRef = storageService.ref();
  
  document.querySelector('.file-select').addEventListener("change", handleFileUploadChange);
  document.querySelector('.file-submit').addEventListener("click", handleFileUploadSubmit);

  let selectedFile;
  function handleFileUploadChange(e) {
    selectedFile = e.target.files[0];
  }; 

  function handleFileUploadSubmit(e) {
  const uploadTask = storageRef.child(`images/${selectedFile.name}`).put(selectedFile); //create a child directory called images, and place the file inside this directory
  uploadTask.on('state_changed', 
    (snapshot) => {
    // Observe state change events such as progress, pause, and resume
    }, 
    (error) => {
      // Handle unsuccessful uploads
      console.log(error);
    }, 
    () => {
      // Do something once upload is complete
      console.log('success')
      var u = uploadTask.snapshot;
      // get the uploaded image url back 
      var urlfromFire= u.ref.getDownloadURL().then( 
        function(downloadURL) { 
        // get url from here 
          console.log('File available at', downloadURL); 
          var imgURL = downloadURL;
          var endpoint = "https://vision.googleapis.com/v1/images:annotate?key=";
          var key = "AIzaSyAkLn-u_TURvuTslpYbWga6e7P4ACqZZQE"

            var req = {
                "requests": [{
                    "image": {
                        "source": {
                            "imageUri": imgURL
                        }
                    },
                    "features": [{
                            "type": "LABEL_DETECTION",
                            "maxResults": 10
                        },
                        { 
                            "type": "LOGO_DETECTION",
                            "maxResults": 3
                        } 

                    ]
                }]
            };

            $.ajax(endpoint + key, {
                    "method": "POST",
                    "contentType": 'application/json; charset=utf-8',
                    "data": JSON.stringify(req)
                })
                .then(function (res) {
                    console.log('success', res);
                    $("#pic").hide(); 
                    $("#myImage").attr("src", imgURL).width(400);
                    $("#result").text(res.responses[0].labelAnnotations[0].description);
                    $("#result2").text(res.responses[0].labelAnnotations[1].description);
                    $("#result3").text(res.responses[0].labelAnnotations[2].description);
                    $("#result4").text(res.responses[0].labelAnnotations[3].description);
                })
                .catch(function (err) {
                    console.log('error', err.responseText);
                })
        }); 
  })


};

 
        
        


</script>
        
                    
    
</body>
</html>